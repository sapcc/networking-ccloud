
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>CC-Fabric ML2 Driver Internals &#8212; networking-ccloud 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/basic.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Switch Config" href="switch-config.html" />
    <link rel="prev" title="Overview" href="overview.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="../_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/sapcc/networking-ccloud/src/doc/source/architecture/driver.rst -->

 <script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>
<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main show">
        <li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li>
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/openstack-components">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/">Open Infrastructure Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/openstackdays">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="https://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="https://docs.openstack.org/">Docs</a>
        </li>
        <li>

</li>


            <li>

                <li class="join-nav-section">
                    <a href="https://openinfra.dev/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
                    <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
                        <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">More about the Foundation</a></li>
                    </ul>
                </li>
                <li>
                    <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
                </li>

            </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>CC-Fabric ML2 Driver Internals</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="overview.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Overview"></i></a>
    
    
    <a href="switch-config.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Switch Config"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="cc-fabric-ml2-driver-internals">
<h1>CC-Fabric ML2 Driver Internals<a class="headerlink" href="#cc-fabric-ml2-driver-internals" title="Permalink to this headline">¶</a></h1>
<p>NOTE: these are currently drafts and thoughts that have been recorded over the course of the project.
Some have been written before implementation, some while implementation was being done. Therefore they
might not be 100% accurate or need a review.</p>
<section id="structural-overview">
<h2>Structural Overview<a class="headerlink" href="#structural-overview" title="Permalink to this headline">¶</a></h2>
</section>
<section id="db-api-and-config-objects-how-they-match-together">
<h2>DB, API and Config Objects &amp; How They Match Together<a class="headerlink" href="#db-api-and-config-objects-how-they-match-together" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>The following API objects are relevant for a network configuration:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">network</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - used as name / reference for this network</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">availability_zone_hints</span></code> - used to decide if a port can be bound in this network</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">admin_state_up</span></code> - <strong>FIXME</strong> should we respect this flag?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">router:external</span></code> - external or internal network</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">subnet</span></code> - belongs to a single network, only relevant for external networks</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">gateway_ip</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">port</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">binding_host</span></code> - host, which will be mapped to a hostgroup by the driver</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binding_profile</span></code> - alternative source for binding host (used by baremetal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">admin_state_up</span></code> - <strong>FIXME</strong> should we respect this flag?</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>The following DB tables are relevant:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">networksegments</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">network_type</span></code> - vxlan or vlan; the driver will only manage vlan segments (vxlan segments are managed by neutron, not us)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">network_id</span></code> - network_id this segment is relevant for</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">physical_network</span></code> - name of the physnet (as defined by hostgroup in driver config)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">segmentation_id</span></code> - vni or vlan id</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">segment_index</span></code> - level of segment, 0 is the top level vxlan segment, 1+ driver managed</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ml2_port_bindings</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">host</span></code> - binding_host, see port</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">profile</span></code> - binding_profile, see port</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vif_details</span></code> - driver-internal extras</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ml2_port_binding_levels</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">driver</span></code> - for each port bound by the driver there has to be a level 0 entry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">host</span></code> - binding_host, again (isn’t this a duplicate?)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>In our driver-config we have:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Hostgroup - maps binding_hosts to vlan pool / physical_network name</dt><dd><ul>
<li><p>NOTE: multiple Hostgroups can reference the same physnet_name</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Host - defines list of interfaces on switches that need to be bound</p></li>
</ul>
</dd>
</dl>
<p>A network consists of multiple networksegments, which hold the vlan and the physical network in question.
Ports are bound to segments and hold a binding_host as well, which should match a host in our config
(else we cannot bind the port).</p>
<dl class="simple">
<dt>So to generate a full config for a network we need to look at the following things:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>all binding_hosts in a network specify which ports are bound to a network</dt><dd><ul>
<li><p>all binding_hosts can be found by querying all ports for a network</p></li>
<li><p>the networksegment they’re bound to carry the vlan id we need to use</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</section>
<section id="sync-operations">
<h2>Sync Operations<a class="headerlink" href="#sync-operations" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>There are three sync operations the driver is using:</dt><dd><ul class="simple">
<li><p>hostgroup-network-sync - sync for a single hostgroupin one network on all switches, used on port bind or port delete</p></li>
<li><p>network-sync - sync all hostgroups for a single network on all switches</p></li>
<li><p>switch-sync - snyc all networks on a single switch</p></li>
</ul>
</dd>
<dt>hostgroup-network-sync bind:</dt><dd><ul class="simple">
<li><p>get hostgroup of binding_host</p></li>
<li><p>find (or create) matching segment</p></li>
<li><p>sync this networksegment to all switches that have interfaces in the hostgroup</p></li>
</ul>
</dd>
<dt>hosgroup-network-sync delete:</dt><dd><ul class="simple">
<li><p>get hostgroup of binding_host</p></li>
<li><p>check if any ports with the same binding_host remain. if so, stop</p></li>
<li><dl class="simple">
<dt>check if any other binding_hosts are using the same interface. if all interfaces are still in use, stop</dt><dd><ul>
<li><p>FIXME: maybe we can check only hosts on the same networksegment?</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>rpc call: remove vlan from all unused interfaces</p></li>
<li><p>find matching network segment</p></li>
<li><p>if no host in current network binds this segment, remove it from DB</p></li>
</ul>
</dd>
<dt>network-sync:</dt><dd><ul class="simple">
<li><p>get all binding_hosts for this network</p></li>
<li><p>get all hostgroups from binding_hosts, generate config with help of segments</p></li>
<li><p>…</p></li>
</ul>
</dd>
<dt>switch-sync:</dt><dd><ul class="simple">
<li><p>get all physical_networks that could be on the switch to sync</p></li>
<li><p>query all networksegments with these physical_networks</p></li>
<li><p>get all ports bound by the driver for this on these segments</p></li>
<li><p>use this to get a list of binding hosts to generate the necessary config</p></li>
<li><p>send to agent, tell it that this is the complete list and other mappings can be cleaned</p></li>
</ul>
</dd>
</dl>
</section>
<section id="agent-design">
<h2>Agent Design<a class="headerlink" href="#agent-design" title="Permalink to this headline">¶</a></h2>
</section>
<section id="agent-communication">
<h2>Agent Communication<a class="headerlink" href="#agent-communication" title="Permalink to this headline">¶</a></h2>
<p>Operation: add, remove, replace</p>
<dl class="simple">
<dt>For communicating a change to an agent we need to include the following information per switch:</dt><dd><ul class="simple">
<li><p>switch identifier</p></li>
<li><dl class="simple">
<dt>list of vni mappins</dt><dd><ul>
<li><p>operation - add, remove, replace</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>list of local vlans</dt><dd><ul>
<li><p>operation - add, remove, replace</p></li>
<li><p>description (network uuid)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>list of interfaces + their config</dt><dd><ul>
<li><p>vlans</p></li>
<li><p>vlan translations</p></li>
<li><p>port-channel id (optional)</p></li>
<li><p>member-interfaces for port-channel (optional)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>Note: For a port-channel all subinterfaces will be overriden with the same config a the moment. An
alternative idea would be to only configure this interface in case of direct-on-fabric stuff, e.g.
native vlans.</p>
</section>
<section id="network-syncloop-in-agent">
<h2>Network Syncloop (in Agent)<a class="headerlink" href="#network-syncloop-in-agent" title="Permalink to this headline">¶</a></h2>
</section>
<section id="network-scheduling-on-borderleafs-and-aci-transits">
<h2>Network Scheduling on Borderleafs and ACI Transits<a class="headerlink" href="#network-scheduling-on-borderleafs-and-aci-transits" title="Permalink to this headline">¶</a></h2>
<p>Both Borderleafs and ACI Transit Switches have a maximum capacity of x VLANS (2000 on Arista, 1750 on ACI).</p>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="overview.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Overview"></i></a>
          
          
            <a href="switch-config.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Switch Config"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2022-02-08 17:34:43</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>networking-ccloud 0.0.0</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Driver Architecutre</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CC-Fabric ML2 Driver Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="switch-config.html">Switch Config</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Networking CCloud VXLAN Fabric service installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor/index.html">Contributor Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command line interface reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">References</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">CC-Fabric ML2 Driver Internals</a><ul>
<li><a class="reference internal" href="#structural-overview">Structural Overview</a></li>
<li><a class="reference internal" href="#db-api-and-config-objects-how-they-match-together">DB, API and Config Objects &amp; How They Match Together</a></li>
<li><a class="reference internal" href="#sync-operations">Sync Operations</a></li>
<li><a class="reference internal" href="#agent-design">Agent Design</a></li>
<li><a class="reference internal" href="#agent-communication">Agent Communication</a></li>
<li><a class="reference internal" href="#network-syncloop-in-agent">Network Syncloop (in Agent)</a></li>
<li><a class="reference internal" href="#network-scheduling-on-borderleafs-and-aci-transits">Network Scheduling on Borderleafs and ACI Transits</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://openstack.org/projects/">Projects</a></li>
          <li><a href="https://www.openstack.org/software/security/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>g
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://openstack.org/community/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="https://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="https://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="https://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="../_static/underscore.js"></script>
<script type="text/javascript" src="../_static/doctools.js"></script>
<script type="text/javascript" src="../_static/searchtools.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.0.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "architecture/driver" + ".rst";
    gitURL = "Source: https://opendev.org/sapcc/networking-ccloud/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: d01b4a0a03c7dfa2ca0f6cfea5a927e033432275";
    var repositoryName = "sapcc/networking-ccloud";
    var bugProject = "replace with the name of the project on Launchpad or the ID from Storyboard";
    var bugTitle = "CC-Fabric ML2 Driver Internals in networking-ccloud";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.0.0 on 2022-02-08 17:34:43";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
</script>


  </body>
</html>