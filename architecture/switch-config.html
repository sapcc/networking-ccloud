
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Switch Config &#8212; networking-ccloud 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/basic.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Networking CCloud VXLAN Fabric service installation guide" href="../install/index.html" />
    <link rel="prev" title="CC-Fabric ML2 Driver Internals" href="driver.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="../_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>
<style>
    body {
        margin: 0;
        display: flex;
        flex-direction: column;
    }

    .juno-pageheader {
        display: flex;
        align-items: center;
        background: rgb(0,8,16);
        position: sticky;
        top: 0;
        padding: 12px 24px;
    }

    .sap-logo {
        height: 24px;
        margin-right: 12px;
    }

    .header-title {
        color: rgb(222,223,224);
        font-family: Arial;
        font-size: 18px;
        line-height: 24px;
    }

    /* class from doc layout -- main container */
    .docs-book-wrapper {
        flex-grow: 1;
        margin-top: 16px;
    }
</style>

<div class="juno-pageheader" role="banner">
    <img src="../_static/images/sap_logo.svg" alt="SAP Logo" class="sap-logo" />
    <div class="header-title">Converged Cloud | networking-ccloud</div>
</div>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>Switch Config</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: CC-Fabric ML2 Driver Internals"></i></a>
    
    
    <a href="../install/index.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Networking CCloud VXLAN Fabric service installation guide"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="switch-config">
<h1>Switch Config<a class="headerlink" href="#switch-config" title="Permalink to this headline">¶</a></h1>
<p>This part describes the on-device config for all feature and vendor combinations.</p>
<section id="normal-vm-portbinding">
<h2>Normal VM portbinding<a class="headerlink" href="#normal-vm-portbinding" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>VXLAN &lt;-&gt; VLAN mapping</p></li>
<li><p>Add a VLAN to ports in questions</p></li>
</ul>
</section>
<section id="baremetal-on-fabric-portbinding">
<h2>Baremetal-on-Fabric portbinding<a class="headerlink" href="#baremetal-on-fabric-portbinding" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>VXLAN &lt;-&gt; VLAN mapping</p></li>
<li><p>Add a VLAN to ports in question</p></li>
<li><p>Set it as native vlan</p></li>
</ul>
</section>
<section id="baremetal-on-fabric-trunk">
<h2>Baremetal-on-Fabric trunk<a class="headerlink" href="#baremetal-on-fabric-trunk" title="Permalink to this headline">¶</a></h2>
<p>…basically same as normal VM portbinding, but port in OpenStack looks different</p>
</section>
<section id="external-network-config-l3-gateway">
<h2>External network config + l3 gateway<a class="headerlink" href="#external-network-config-l3-gateway" title="Permalink to this headline">¶</a></h2>
<p>TBD</p>
</section>
<section id="management-networks">
<h2>Management Networks<a class="headerlink" href="#management-networks" title="Permalink to this headline">¶</a></h2>
<p>TBD, config is also not yet specified for this</p>
</section>
<section id="host-lending">
<h2>Host lending<a class="headerlink" href="#host-lending" title="Permalink to this headline">¶</a></h2>
<p>Mass VLAN translations in original home of server.
FIXME: Scalability considerations</p>
</section>
<section id="aci-transit-connection">
<h2>ACI transit connection<a class="headerlink" href="#aci-transit-connection" title="Permalink to this headline">¶</a></h2>
<p>The Transit (or ACI Transit) is used to connect the fabric to another ml2
top level driver, like our networking-arista driver. The ACI driver and this
driver (networking-ccloud) both share responsibility for the top hierarchy.
For this to work they need to be interconnected. This means that whenever
an OpenStack network should be present both on ACI and networking-ccloud side
it needs a transit between these two fabrics.</p>
<p>The transit is done by having two switches connected with each other, one on
each side and having the drivers coordinate on the VLANs used there. networking-ccloud
will create the necessary segment, as it is on top of the hierarchy.</p>
<dl class="simple">
<dt>Other drivers will have to be notified of this change, options are:</dt><dd><ul class="simple">
<li><p>having an own signal in bind_port</p></li>
<li><p>use <cite>(create|update|delete)_port_postcommit</cite> (or something alike)</p></li>
</ul>
</dd>
</dl>
<p>In config (and NetBox) each Transit will have a list of AZs associated with it
that it feels respnosible for. Whenever a network is either stretched across
AZs or is present in at least one AZ and on the “other side” (e.g. ACI) the
driver will schedule the network to an ACI transit for each AZ it is in.
One Transit can be responsible for multiple AZs. If a Transit is in a
different AZ than other portbindings, BGWs will be configured for inter-AZ
communication inside the fabric. When the Transit is no longer needed (e.g.
when the last port in one AZ is removed and no other AZ is using this transit
then the scheduling of this (AZ, Transit, Network) and its respective segment / VLAN
allocation will be removed.</p>
<dl class="simple">
<dt>How scheduling / binding roughly works:</dt><dd><ul class="simple">
<li><p>find AZs of network</p></li>
<li><p>make sure every (network / AZ) combination has a Transit assigned (if available)</p></li>
<li><dl class="simple">
<dt>if new transit is scheduled</dt><dd><ul>
<li><p>allocate segment</p></li>
<li><p>schedule / handle BGWs (if Transit is in different zone)</p></li>
<li><p>add transit to binding hosts? (FIXME)</p></li>
<li><p>bind segment</p></li>
<li><p>notify others</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>Note: Scheduling of BGWs is something we need to take care of here as well. Not every
AZ has to have a Transit. In some cases Tranits of other AZs take over. If the Transit
is the first binding in a new AZ we need to schedule the BGW for this AZ and then, again,
a Transit for this AZ. We probably should make sure this is the same Transit and enforce
via config that a Transit has to serve at least its own AZ.</p>
<blockquote>
<div><ul class="simple">
<li><p>[0,n] transit pairs per AZ</p></li>
<li><p>1750 vlans per transit</p></li>
<li><dl class="simple">
<dt>transit in one AZ needs to be bound when port present in AZ x and</dt><dd><ul>
<li><p>port in ACI</p></li>
<li><p>port in AZ y != x</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>each AZ needs a transit that handles its traffic</dt><dd><ul>
<li><p>each transit has one or more AZs it’s responsible for</p></li>
<li><p>driver will schedule each AZ the network is in onto a transit</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</section>
<section id="inter-az-communication-bordergateways-bgws">
<h2>Inter-AZ communication / BorderGateWays (BGWs)<a class="headerlink" href="#inter-az-communication-bordergateways-bgws" title="Permalink to this headline">¶</a></h2>
<p>Configure something on the borderleafs, devicerole foo.</p>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: CC-Fabric ML2 Driver Internals"></i></a>
          
          
            <a href="../install/index.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Networking CCloud VXLAN Fabric service installation guide"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2022-03-11 15:54:48</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">

            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" class="btn docs-sidebar-release-select">SAP CCloud Fabric Documentation</button>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>networking-ccloud 0.0.0</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Driver Architecutre</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver.html">CC-Fabric ML2 Driver Internals</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Switch Config</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Networking CCloud VXLAN Fabric service installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor/index.html">Contributor Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command line interface reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">References</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">Switch Config</a><ul>
<li><a class="reference internal" href="#normal-vm-portbinding">Normal VM portbinding</a></li>
<li><a class="reference internal" href="#baremetal-on-fabric-portbinding">Baremetal-on-Fabric portbinding</a></li>
<li><a class="reference internal" href="#baremetal-on-fabric-trunk">Baremetal-on-Fabric trunk</a></li>
<li><a class="reference internal" href="#external-network-config-l3-gateway">External network config + l3 gateway</a></li>
<li><a class="reference internal" href="#management-networks">Management Networks</a></li>
<li><a class="reference internal" href="#host-lending">Host lending</a></li>
<li><a class="reference internal" href="#aci-transit-connection">ACI transit connection</a></li>
<li><a class="reference internal" href="#inter-az-communication-bordergateways-bgws">Inter-AZ communication / BorderGateWays (BGWs)</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<style>
    .juno-pagefooter {
        display: flex;
        position: relative;
        background: rgba(41, 47, 54, 1);
        min-height: 56px;
    }

    .ccloud-shape {
        height: 42px;
        position: absolute;
        right: 0;
        bottom: 0;
    }
</style>

<div class="juno-pagefooter" role="contentinfo">
    <img src="../_static/images/ccloud_shape.svg" alt="Converged Cloud cloud shape" class="ccloud-shape" />
</div>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="../_static/underscore.js"></script>
<script type="text/javascript" src="../_static/doctools.js"></script>
<script type="text/javascript" src="../_static/searchtools.js"></script>
<script type="text/javascript" src="../_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.0.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
</script>


  </body>
</html>