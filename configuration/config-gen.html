
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Netbox Config Generator &#8212; networking-ccloud 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/basic.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Driver Configuration" href="config-driver.html" />
    <link rel="prev" title="Configuration" href="index.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="../_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>
<style>
    body {
        margin: 0;
        display: flex;
        flex-direction: column;
    }

    .juno-pageheader {
        display: flex;
        align-items: center;
        background: rgb(0,8,16);
        position: sticky;
        top: 0;
        padding: 12px 24px;
    }

    .sap-logo {
        height: 24px;
        margin-right: 12px;
    }

    .header-title {
        color: rgb(222,223,224);
        font-family: Arial;
        font-size: 18px;
        line-height: 24px;
    }

    /* class from doc layout -- main container */
    .docs-book-wrapper {
        flex-grow: 1;
        margin-top: 16px;
    }
</style>

<div class="juno-pageheader" role="banner">
    <img src="../_static/images/sap_logo.svg" alt="SAP Logo" class="sap-logo" />
    <div class="header-title">Converged Cloud | networking-ccloud</div>
</div>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>Netbox Config Generator</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="index.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Configuration"></i></a>
    
    
    <a href="config-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Driver Configuration"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="netbox-config-generator">
<h1>Netbox Config Generator<a class="headerlink" href="#netbox-config-generator" title="Permalink to this heading">¶</a></h1>
<p>Netbox Config Generator will fetch all devices that belong to below Netbox roles. It will then fetch all interfaces and create hostgroups from clusters that are connected to the interfaces.
The driver configuration is generated based on input from external tooling (Netbox).</p>
<p>A reference how the Config Generator expects Netbox objects can be found in <a class="reference external" href="https://github.com/sapcc/networking-ccloud/blob/HEAD/networking_ccloud/tools/netbox_modelr.py">netbox_model.py</a></p>
<section id="run">
<h2>Run<a class="headerlink" href="#run" title="Permalink to this heading">¶</a></h2>
<p>The config generator is available under <code class="code docutils literal notranslate"><span class="pre">networking_ccloud/tools/netbox_config_gen.py</span></code> using the entrypoint <code class="code docutils literal notranslate"><span class="pre">cc-netbox-config-gen</span></code>.</p>
<p>It does support nesting the configuration under certain YAML keys if the config need to be picked up by helm. Use the <code class="code docutils literal notranslate"><span class="pre">--wrap-in</span></code> parameter for that.</p>
<p>Vault references can also be injected instead of plain-text passwords using the <code class="code docutils literal notranslate"><span class="pre">--vault-ref</span></code> parameter.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cc-netbox-config-gen -r $OS_REGION_NAME -u MYAPIUSER -V $OS_REGION_NAME/my/vault/path -w cc_fabric/driver_config -o $PATH_TO_HELM_VALUES/$OS_REGION_NAME/values/neutron-cc-fabric.yaml
</pre></div>
</div>
</section>
</section>
<section id="managed-devices">
<h2>Managed Devices<a class="headerlink" href="#managed-devices" title="Permalink to this heading">¶</a></h2>
<p>All fabric members must be of the following Netbox roles:</p>
<ul class="simple">
<li><p><strong>EVPN Spine</strong>: Used for all spine switches, not configured by driver</p></li>
<li><p><strong>EVPN Leaf</strong>: Used for all leaf switches in the EVPN fabric</p></li>
</ul>
<p>Devices can be explicitly ignored if they are tagged using the <code class="code docutils literal notranslate"><span class="pre">cc-net-driver-ignore</span></code> tag. Devices will be picked up when they are in state <em>staged</em> or <em>active</em>.</p>
<section id="hostnames">
<h3>Hostnames<a class="headerlink" href="#hostnames" title="Permalink to this heading">¶</a></h3>
<p>Leaf pair hostnames must be compliant with the following regex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>^(?P&lt;region&gt;\w{2}-\w{2}-\d)-sw(?P&lt;az&gt;\d)(?P&lt;pod&gt;\d)(?P&lt;switchgroup&gt;\d{2})(?P&lt;leaf&gt;[ab])(?:-(?P&lt;role&gt;[a-z]+(?P&lt;bb_no&gt;[0-9]+)?))$
</pre></div>
</div>
<p>Or in a more readable way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">region</span><span class="p">]</span><span class="o">-</span><span class="n">sw</span><span class="p">[</span><span class="n">az</span><span class="p">][</span><span class="n">pod</span><span class="p">][</span><span class="n">switchgroup</span><span class="p">][</span><span class="n">leaf</span><span class="p">][</span><span class="n">role</span><span class="p">]</span>
<span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="n">eu</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">sw4223a</span><span class="o">-</span><span class="n">bb147</span>
</pre></div>
</div>
<p>Where the following conditions apply to the variables:</p>
<p>Each leaf pair (MLAG/VPC) requires a fabric unique 4 digit ID ([az][pod][switchgroup]) with an a/b identifier for leaf in group per leaf pair used to generate device specific configuration settings (ASN etc.)</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>region</p></td>
<td><p>in the fashion like ‘eu-de-1’,</p></td>
</tr>
<tr class="row-even"><td><p>az</p></td>
<td><p>single digit indicating the AZ, 1: AZ a, 2: AZ b, …</p></td>
</tr>
<tr class="row-odd"><td><p>pod</p></td>
<td><p>single non zero digit indicating the pod</p></td>
</tr>
<tr class="row-even"><td><p>switchgroup</p></td>
<td><p>a 2 digit number uniquely identifying the leaf pair in a region</p></td>
</tr>
<tr class="row-odd"><td><p>leaf</p></td>
<td><p>a=fist leaf in pair, b=second leaf in pair</p></td>
</tr>
<tr class="row-even"><td><p>role</p></td>
<td><p>any sequence of lower case characters followed by digits as a pod identifier, such as bb147. The pod identifier is optional.</p></td>
</tr>
</tbody>
</table>
<p>Each leaf pair (MLAG/VPC) requires a fabric unique 4 digit ID <code class="code docutils literal notranslate"><span class="pre">(f{az}{pod}{switchgroup})</span></code> with an a/b identifier for leaf in group per leaf pair used to generate device specific configuration settings (ASN etc.)</p>
</section>
<section id="leaf-types">
<h3>Leaf Types<a class="headerlink" href="#leaf-types" title="Permalink to this heading">¶</a></h3>
<p>All fabric leaf switches must be tagged with exactly one of below subrole identifiers.</p>
<section id="ccloud-pod-leaves">
<h4>CCloud Pod Leaves<a class="headerlink" href="#ccloud-pod-leaves" title="Permalink to this heading">¶</a></h4>
<p>Any leaf connecting any CC platform equipment must be tagged with the applicable tag of the following:</p>
<ul class="simple">
<li><p>CC-APOD</p></li>
<li><p>CC-BPOD</p></li>
<li><p>CC-NETPOD</p></li>
<li><p>CC-STPOD</p></li>
<li><p>CC-VPOD</p></li>
</ul>
</section>
<section id="cnd-evpn-leaf-types">
<h4>CND EVPN Leaf Types:<a class="headerlink" href="#cnd-evpn-leaf-types" title="Permalink to this heading">¶</a></h4>
<p>The driver needs to identify certain non-pod leaf pairs to
push tenant configuration:</p>
<ul class="simple">
<li><p><strong>CND-NET-EVPN-BL</strong>: Border leaf connecting to core routing, required for subnet pool summarization</p></li>
<li><p><strong>CND-NET-EVPN-TL</strong>: Transit leaf connecting to a legacy fabric for migration purposes</p></li>
<li><p><strong>CND-NET-EVPN-BG</strong>: Used for all gateways interconnecting CC AZ’s in a multi AZ fabric</p></li>
</ul>
</section>
</section>
</section>
<section id="l2-l3-networks">
<h2>L2/L3 Networks<a class="headerlink" href="#l2-l3-networks" title="Permalink to this heading">¶</a></h2>
<section id="tenant-network-vlan-range">
<h3>Tenant Network VLAN range<a class="headerlink" href="#tenant-network-vlan-range" title="Permalink to this heading">¶</a></h3>
<p>The default VLAN range for any physnet will be assumed to be in the range from <strong>2000-3750</strong>.</p>
<p>If for a device a different (or reduced) range is in effect it must be expressed in the Netbox device config context as a list of single values or ranges for that device, ranges are including first and last value. This must look like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;cc&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;net&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;evpn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;tenant-vlan-range&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;2000&quot;</span><span class="p">,</span>
                <span class="s2">&quot;2100:3000&quot;</span>
            <span class="p">],</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="infrastructure-networks">
<span id="infrastructure-networks-from-netbox"></span><h3>Infrastructure Networks<a class="headerlink" href="#infrastructure-networks" title="Permalink to this heading">¶</a></h3>
<p>also see <a class="reference internal" href="config-driver.html#infrastructure-network-config"><span class="std std-ref">infra_networks</span></a>.</p>
<p>Infrastructure Networks can be pure layer 2 or layer 3. These must be modelled in Netbox as follows in order to be picked up.</p>
<p>Layer 2 Infrastructure Networks need to have:</p>
<ul class="simple">
<li><p>A <em>VLAN</em> object with a corresponding <em>VLAN group</em>,</p></li>
<li><p><em>VLANs</em> must only be bound to the logical interface, so if an interface is a LAG member, the VLAN object must be bound on the LAG,</p></li>
<li><p>a <em>VLAN group</em> with a naming scheme for which a VNI allocation logic is defined (currently only for cc-vpod <em>VLAN groups</em>, see <code class="code docutils literal notranslate"><span class="pre">derive_vlan_vni</span></code> in <a class="reference external" href="https://github.com/sapcc/networking-ccloud/blob/HEAD/networking_ccloud/tools/netbox_config_gen.py">netbox_config_gen.py</a>  and <a class="reference internal" href="#vlan-to-vni">vlan-to-vni</a> for reference).</p></li>
</ul>
<p>If an Infrastructure Network shall be layer 3 enabled, the following conditions need to be met additionally (see <code class="code docutils literal notranslate"><span class="pre">get_infra_network_l3_data</span></code> in <a class="reference external" href="https://github.com/sapcc/networking-ccloud/blob/HEAD/networking_ccloud/tools/netbox_config_gen.py">netbox_config_gen.py</a> for reference):</p>
<ul class="simple">
<li><p>The <em>VLAN</em> object must have a prefix associated,</p></li>
<li><p>the prefix must have the correct VRF assigned,</p></li>
<li><p>the prefix should be subnetted from the pod-specific management supernet if applicable,</p></li>
<li><p>the prefix must have a parent prefix associated which will be added as an BGP aggregate to the config.</p></li>
</ul>
<p>In addition, we expect all layer 3 Infrastructure Networks to be anycast-gateway routed. As these anycast gateways live on the TOR leaf, those must be moddeled as follows:</p>
<ul class="simple">
<li><p>The SVI interface must be created on both leaf switches of a pod,</p></li>
<li><p>the SVI interface must be exactly named as SVI interfaces are named in the device specific configuration,</p></li>
<li><p>each SVI interface must have an <em>IP Address</em> object linked that associates to the <em>VRF</em> it routes and must be of type <em>anycast</em>,</p></li>
<li><p>the SVI interface must also have the VLAN it corresponds to set as <em>unatagged_vlan</em>.</p></li>
</ul>
<section id="dhcp-relay-not-implemented-so-far">
<h4>DHCP Relay (not implemented so far)<a class="headerlink" href="#dhcp-relay-not-implemented-so-far" title="Permalink to this heading">¶</a></h4>
<p>For infra networks requiring a DHCP relay one or more Netbox <em>Tags</em>
must be added to the <em>VLAN</em> object, one for each DHCP relay server
in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CC</span><span class="o">-</span><span class="n">NET</span><span class="o">-</span><span class="n">EVPN</span><span class="o">-</span><span class="n">DHCP</span><span class="o">-</span><span class="n">RELAY</span><span class="p">:</span><span class="mf">10.10.10.10</span>
<span class="n">CC</span><span class="o">-</span><span class="n">NET</span><span class="o">-</span><span class="n">EVPN</span><span class="o">-</span><span class="n">DHCP</span><span class="o">-</span><span class="n">RELAY</span><span class="p">:</span><span class="mf">10.11.11.11</span>
</pre></div>
</div>
</section>
</section>
<section id="extra-vlans">
<span id="extra-vlans-from-netbox"></span><h3>Extra VLANs<a class="headerlink" href="#extra-vlans" title="Permalink to this heading">¶</a></h3>
<p>also see <a class="reference internal" href="config-driver.html#extra-vlan-config"><span class="std std-ref">extra_vlans</span></a>.</p>
<p>Whenever an extra VLAN is required, it needs to be modelled in Netbox in order to be picked up:</p>
<ul class="simple">
<li><p>There must be a <em>VLAN</em> object existing,</p></li>
<li><p>the <em>VLAN</em> must be assigned to the logical port in <em>tagged</em> mode,</p></li>
<li><p>the <em>VLAN</em> or its associated VLAN group must have the <code class="code docutils literal notranslate"><span class="pre">cc-net-driver-extra-vlan</span></code>.</p></li>
</ul>
<p>As our Netbox version currently does not yet support tags on VLAN groups, we additionally consider the following VLANs as extra VLANs as long as Netbox is not upgraded:</p>
<ul class="simple">
<li><p><em>VLAN group</em> name starts with region and ends with <code class="code docutils literal notranslate"><span class="pre">cp</span></code></p></li>
<li><p><em>VLAN group</em> name is <code class="code docutils literal notranslate"><span class="pre">f'{region}-regional</span></code></p></li>
<li><p><em>VLAN group</em> name is <code class="code docutils literal notranslate"><span class="pre">global-cc-core-transit</span></code></p></li>
</ul>
</section>
<section id="l2-networks-vlan-to-vni-mapping">
<span id="vlan-to-vni"></span><h3>L2 Networks VLAN to VNI mapping<a class="headerlink" href="#l2-networks-vlan-to-vni-mapping" title="Permalink to this heading">¶</a></h3>
<p>Netbox does not yet support a model for overlay network VNIs, the following conventions are used:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Network Type</p></th>
<th class="head"><p>VNI Allocation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Infra Regional</p></td>
<td><p>VLAN X uses VNI X (VLAN 100 -&gt; VNI 100)</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Infra AZ-wide</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">VLAN X uses VNI [AZ-Prefix]X</div>
<div class="line">i.e VLAN 800, AZ=a -&gt; 100800, VLAN = 800, AZ=b -&gt; 200800</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Infra Pod-specific</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">VLAN X re-used in many pods as local vlan,</div>
<div class="line">1PPPPVVV with P=Pod ID 4-Digit with leading zeros,</div>
<div class="line">V=Local VLAN id 3-Digit with leading zeros.</div>
<div class="line">i.e Vlan 100 in vPOD 371 -&gt; VNI=10371100</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>Tenant</p></td>
<td><p>CCloud platform driver should use range 10000 - 65535</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ports-and-interfaces">
<h2>Ports and Interfaces<a class="headerlink" href="#ports-and-interfaces" title="Permalink to this heading">¶</a></h2>
<p>The driver is responsible for front ports on pod equipment, configures certain infra networks on such ports or
bundles ports in LAG and MLAG logical interfaces. This section describes Netbox modelling requirements for the driver’s input.</p>
<section id="cables">
<h3>Cables<a class="headerlink" href="#cables" title="Permalink to this heading">¶</a></h3>
<p>All cables must be modelled according to physical connections. Cables must be marked as <cite>installed</cite> when installed.
This does also include Leaf to Spine links, which are necessary for diagnostic tooling.</p>
</section>
<section id="rules-for-driver-managed-interfaces">
<h3>Rules for Driver Managed Interfaces<a class="headerlink" href="#rules-for-driver-managed-interfaces" title="Permalink to this heading">¶</a></h3>
<p>All interfaces that have a connected endpooint which satisfies the following conditions will be picked up:</p>
<ul class="simple">
<li><p><em>connected device</em> -&gt; <em>device role</em> is one of <em>server</em>, <em>neutron-router</em>, <em>loadbalancer</em>, and</p></li>
<li><p>the tenant is <em>Converged Cloud</em>, and</p></li>
<li><p>the interface must be a member of a LAG in the driver managed LAG range, and</p></li>
<li><p>there must not be a <code class="code docutils literal notranslate"><span class="pre">cc-net-driver-ignore</span></code> tag on the interface,</p></li>
</ul>
<p>or</p>
<ul class="simple">
<li><p><em>connected device</em> -&gt; <em>device role</em> is <em>filer</em>, and</p></li>
<li><p>the <em>connected device</em> has a <em>parent device</em> (a chassis it resides in), and</p></li>
<li><p>the interface must be a member of a LAG in the driver managed LAG range, and</p></li>
<li><p>the <em>parent device</em> is tagged with <code class="code docutils literal notranslate"><span class="pre">manila</span></code>.</p></li>
</ul>
<p>If the one of the following conditions is met, the devices will also be gathered in a metagroup:</p>
<ul class="simple">
<li><p>the <em>connected device</em>’s cluster type is one of the following <em>cc-vsphere-prod</em>, <em>neutron-router-pair</em>, <em>cc-k8s-controlplane</em>, <em>cc-f5-vcmp</em>, or</p></li>
<li><p>the <em>connected device</em>’s parent device is tagged with <code class="code docutils literal notranslate"><span class="pre">manila</span></code>.</p></li>
</ul>
</section>
<section id="link-aggregation-groups">
<h3>Link Aggregation Groups<a class="headerlink" href="#link-aggregation-groups" title="Permalink to this heading">¶</a></h3>
<p>LAGs must be defined in Netbox by creating a new interface of type <em>LAG</em>, the interface must be <em>enabled</em>. A LAG interface’s
name must exact-match the full name in the vendor specific configuration, i.e <em>Port-Channel</em> for Arista EOS, <em>Port-channel</em> for Cisco NXOS.
All member interfaces must be made a member of the LAG interface in Netbox.</p>
<p>The driver will assemble all lags that are known to it in its config. Within CCloud we must follow this convention
which is not policy enforced at the moment. However the netbox modeller will generate LAG-ids based on this.</p>
<p>LAGs can either have ports only on one leaf or be spanned across two leaves (MLAG/vPC).
The following convention will be used to distinguish the two
variants:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">port</span><span class="o">-</span><span class="n">channel100</span> <span class="n">defined</span> <span class="n">on</span> <span class="n">device</span> <span class="mi">1110</span><span class="n">a</span> <span class="n">only</span><span class="p">:</span> <span class="n">a</span> <span class="n">regular</span> <span class="n">port</span><span class="o">-</span><span class="n">channel</span> <span class="n">will</span> <span class="n">be</span> <span class="n">configured</span>
<span class="n">port</span><span class="o">-</span><span class="n">channel100</span> <span class="n">defined</span> <span class="n">on</span> <span class="n">device</span> <span class="mi">1110</span><span class="n">a</span> <span class="n">AND</span> <span class="mi">1110</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="n">MLAG</span><span class="o">/</span><span class="n">vPC</span> <span class="n">will</span> <span class="n">be</span> <span class="n">configured</span>
</pre></div>
</div>
<span id="lag-ranges"></span><table class="docutils align-default" id="id1">
<caption><span class="caption-text">LAG Ranges</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Port-Channel ID</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>MLAG or vPC peer link</p></td>
</tr>
<tr class="row-odd"><td><p>2-3</p></td>
<td><p>reserved for admin switch connectivity</p></td>
</tr>
<tr class="row-even"><td><p>4-9</p></td>
<td><p>reserved for future use</p></td>
</tr>
<tr class="row-odd"><td><p>10-99</p></td>
<td><p>reserved for non-driver controlled Port-channels</p></td>
</tr>
<tr class="row-even"><td><p>100-999</p></td>
<td><p>reserved for driver controlled Port-channels</p></td>
</tr>
</tbody>
</table>
</section>
<section id="netbox-modeller-lag-id-generation">
<h3>Netbox Modeller LAG ID Generation<a class="headerlink" href="#netbox-modeller-lag-id-generation" title="Permalink to this heading">¶</a></h3>
<p>Driver controlled and hence netbox modeller generated LAGs have the ID space from 100-999.
We will generate the id based on the <cite>interface index</cite> and the <cite>slot number</cite>. <cite>slot number</cite> refers to either the
number of the linecard or the number of the interface that is broken out (if breakout cables are used). Interface index
refers to interface number within that linecard or breakout group. We will never form LAGs over multiple breakouts
or linecards. If multiple interfaces are used, the lowest <cite>interface index</cite> will be used.
The LAG ID will then be calculated using <cite>slot_number * 100 + interface_index</cite>.</p>
</section>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="index.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Configuration"></i></a>
          
          
            <a href="config-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Driver Configuration"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2022-10-24 16:16:58</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">

            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" class="btn docs-sidebar-release-select">SAP CCloud Fabric Documentation</button>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>networking-ccloud 0.0.0</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">Driver Architecutre</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Networking CCloud VXLAN Fabric service installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor/index.html">Contributor Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Configuration</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Netbox Config Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-driver.html">Driver Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-oslo.html">Oslo Config</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command line interface reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">References</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">Netbox Config Generator</a><ul>
<li><a class="reference internal" href="#run">Run</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#managed-devices">Managed Devices</a><ul>
<li><a class="reference internal" href="#hostnames">Hostnames</a></li>
<li><a class="reference internal" href="#leaf-types">Leaf Types</a><ul>
<li><a class="reference internal" href="#ccloud-pod-leaves">CCloud Pod Leaves</a></li>
<li><a class="reference internal" href="#cnd-evpn-leaf-types">CND EVPN Leaf Types:</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#l2-l3-networks">L2/L3 Networks</a><ul>
<li><a class="reference internal" href="#tenant-network-vlan-range">Tenant Network VLAN range</a></li>
<li><a class="reference internal" href="#infrastructure-networks">Infrastructure Networks</a><ul>
<li><a class="reference internal" href="#dhcp-relay-not-implemented-so-far">DHCP Relay (not implemented so far)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extra-vlans">Extra VLANs</a></li>
<li><a class="reference internal" href="#l2-networks-vlan-to-vni-mapping">L2 Networks VLAN to VNI mapping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ports-and-interfaces">Ports and Interfaces</a><ul>
<li><a class="reference internal" href="#cables">Cables</a></li>
<li><a class="reference internal" href="#rules-for-driver-managed-interfaces">Rules for Driver Managed Interfaces</a></li>
<li><a class="reference internal" href="#link-aggregation-groups">Link Aggregation Groups</a></li>
<li><a class="reference internal" href="#netbox-modeller-lag-id-generation">Netbox Modeller LAG ID Generation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<style>
    .juno-pagefooter {
        display: flex;
        position: relative;
        background: rgba(41, 47, 54, 1);
        min-height: 56px;
    }

    .ccloud-shape {
        height: 42px;
        position: absolute;
        right: 0;
        bottom: 0;
    }
</style>

<div class="juno-pagefooter" role="contentinfo">
    <img src="../_static/images/ccloud_shape.svg" alt="Converged Cloud cloud shape" class="ccloud-shape" />
</div>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="../_static/underscore.js"></script>
<script type="text/javascript" src="../_static/doctools.js"></script>
<script type="text/javascript" src="../_static/searchtools.js"></script>
<script type="text/javascript" src="../_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.0.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
</script>


<script type="text/javascript">
    $(document).ready(function(){

          $.ajax({
            context: this,
            dataType : "html",
            url : "https://docs.openstack.org/latest/badge.html",
            success : function(results) {
                $('#deprecated-badge-container').html(results);
            }
        });
    });
</script>
<div id="deprecated-badge-container"></div>

  </body>
</html>